"""Скрипт для добавления примеров проектов в базу данных"""
from app.database import Project, SessionLocal, init_db
from datetime import datetime, UTC

# Инициализация базы данных
init_db()

# Создание сессии
db = SessionLocal()

# Примеры проектов
examples = [
    {
        "title": "Мобильное приложение для доставки еды",
        "industry": "Еда и рестораны",
        "results": [
            "Увеличение заказов на 150% за первые 3 месяца",
            "Средний рейтинг приложения 4.8 из 5",
            "Обработка более 1000 заказов в день",
            "Интеграция с 50+ ресторанами"
        ],
        "timeline": "3-4 месяца",
        "budget": "45 000$",
        "benefits": "Клиент получил современное мобильное приложение с удобным интерфейсом, которое значительно увеличило количество заказов и улучшило пользовательский опыт. Приложение работает стабильно и быстро обрабатывает большой поток заказов.",
        "tech_stack": {
            "Frontend": "React Native",
            "Backend": "Python FastAPI",
            "База данных": "PostgreSQL",
            "Платежи": "Stripe API",
            "Карты": "Google Maps API"
        },
        "images": None
    },
    {
        "title": "Платформа для онлайн-обучения",
        "industry": "Образование",
        "results": [
            "Более 5000 активных студентов",
            "50+ курсов доступно на платформе",
            "Средняя оценка курсов 4.7 из 5",
            "Интеграция видеоконференций для живых занятий"
        ],
        "timeline": "4-5 месяцев",
        "budget": "60 000$",
        "benefits": "Создана полнофункциональная платформа для онлайн-обучения с возможностью проведения видеоконференций, отслеживания прогресса студентов и автоматической проверки заданий. Платформа масштабируется и может обслуживать тысячи пользователей одновременно.",
        "tech_stack": {
            "Frontend": "Vue.js 3",
            "Backend": "Node.js Express",
            "База данных": "MongoDB",
            "Видео": "WebRTC",
            "Хранилище": "AWS S3"
        },
        "images": None
    },
    {
        "title": "Система управления складом",
        "industry": "Логистика и склад",
        "results": [
            "Сокращение времени обработки заказов на 40%",
            "Автоматизация инвентаризации",
            "Интеграция с 10+ транспортными компаниями",
            "Точность учета товаров 99.5%"
        ],
        "timeline": "5-6 месяцев",
        "budget": "75 000$",
        "benefits": "Внедрена автоматизированная система управления складом с интеграцией штрих-кодов, автоматической инвентаризацией и оптимизацией маршрутов сборки заказов. Система значительно сократила время обработки и уменьшила количество ошибок.",
        "tech_stack": {
            "Backend": "Python Django",
            "База данных": "PostgreSQL",
            "Frontend": "React",
            "API": "REST API",
            "Интеграции": "1C, SAP"
        },
        "images": None
    },
    {
        "title": "Маркетплейс для продажи handmade товаров",
        "industry": "E-commerce",
        "results": [
            "Более 200 активных продавцов",
            "5000+ товаров на платформе",
            "Обработка платежей через 3 платежные системы",
            "Мобильное приложение для iOS и Android"
        ],
        "timeline": "6-7 месяцев",
        "budget": "85 000$",
        "benefits": "Создан полнофункциональный маркетплейс с системой рейтингов продавцов, безопасными платежами и удобным поиском товаров. Платформа поддерживает мобильные приложения и имеет встроенную систему уведомлений.",
        "tech_stack": {
            "Frontend": "Next.js",
            "Backend": "Python FastAPI",
            "База данных": "PostgreSQL + Redis",
            "Платежи": "Stripe, PayPal, YooKassa",
            "Мобильные": "React Native"
        },
        "images": None
    },
    {
        "title": "Система аналитики для фитнес-клубов",
        "industry": "Спорт и фитнес",
        "results": [
            "Интеграция с 20+ фитнес-клубами",
            "Отслеживание более 10 000 тренировок в месяц",
            "Персонализированные рекомендации для клиентов",
            "Дашборд для администраторов клубов"
        ],
        "timeline": "3-4 месяца",
        "budget": "50 000$",
        "benefits": "Разработана система аналитики, которая помогает фитнес-клубам отслеживать посещаемость, анализировать популярность тренировок и предоставлять персонализированные рекомендации клиентам. Система интегрируется с существующими системами клубов.",
        "tech_stack": {
            "Backend": "Python FastAPI",
            "База данных": "PostgreSQL",
            "Frontend": "React + TypeScript",
            "Аналитика": "Python Pandas",
            "Визуализация": "Chart.js"
        },
        "images": None
    }
]

try:
    # Добавление примеров в базу данных
    for example in examples:
        project = Project(
            title=example["title"],
            industry=example["industry"],
            timeline=example["timeline"],
            budget=example["budget"],
            benefits=example["benefits"],
            created_at=datetime.now(UTC),
            updated_at=datetime.now(UTC)
        )
        project.set_results_list(example["results"])
        project.set_tech_stack_dict(example["tech_stack"])
        if example["images"]:
            project.set_images_list(example["images"])
        
        db.add(project)
    
    # Сохранение изменений
    db.commit()
    print(f"Успешно добавлено {len(examples)} примеров проектов в базу данных")
    
except Exception as e:
    db.rollback()
    print(f"Ошибка при добавлении примеров: {e}")
    raise
finally:
    db.close()
